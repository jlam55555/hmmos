<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HmmOS: mem::phys::PageFrameTable Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HmmOS
   </div>
   <div id="projectbrief">System for Operating</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>mem</b></li><li class="navelem"><b>phys</b></li><li class="navelem"><a class="el" href="classmem_1_1phys_1_1PageFrameTable.html">PageFrameTable</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classmem_1_1phys_1_1PageFrameTable-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">mem::phys::PageFrameTable Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>An array containing one page frame descriptor for each physical 4KB page.  
 <a href="classmem_1_1phys_1_1PageFrameTable.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="page__frame__table_8h_source.html">page_frame_table.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a56dc9eff1402b1fd2c5177467a3d9797"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmem_1_1phys_1_1PageFrameTable.html#a56dc9eff1402b1fd2c5177467a3d9797">PageFrameTable</a> (std::span&lt; <a class="el" href="structe820__mm__entry.html">e820_mm_entry</a> &gt; mm)</td></tr>
<tr class="separator:a56dc9eff1402b1fd2c5177467a3d9797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66e964e36a63f7fc2a63d8c31c330eb"><td class="memItemLeft" align="right" valign="top"><a id="ac66e964e36a63f7fc2a63d8c31c330eb" name="ac66e964e36a63f7fc2a63d8c31c330eb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>NON_MOVABLE</b> (<a class="el" href="classmem_1_1phys_1_1PageFrameTable.html">PageFrameTable</a>)</td></tr>
<tr class="separator:ac66e964e36a63f7fc2a63d8c31c330eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65bbd097bc3ce2233fbbc88edafa29c"><td class="memItemLeft" align="right" valign="top"><a id="ac65bbd097bc3ce2233fbbc88edafa29c" name="ac65bbd097bc3ce2233fbbc88edafa29c"></a>
<a class="el" href="classmem_1_1phys_1_1PageFrameDescriptor.html">PageFrameDescriptor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_pfd</b> (uint64_t pf_offset)</td></tr>
<tr class="memdesc:ac65bbd097bc3ce2233fbbc88edafa29c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get PFD from offset. <br /></td></tr>
<tr class="separator:ac65bbd097bc3ce2233fbbc88edafa29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e44c15d23b0037f363f4e932215b96b"><td class="memItemLeft" align="right" valign="top"><a id="a4e44c15d23b0037f363f4e932215b96b" name="a4e44c15d23b0037f363f4e932215b96b"></a>
uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>get_pf_offset</b> (<a class="el" href="classmem_1_1phys_1_1PageFrameDescriptor.html">PageFrameDescriptor</a> &amp;pfd)</td></tr>
<tr class="memdesc:a4e44c15d23b0037f363f4e932215b96b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get offset from PFD. <br /></td></tr>
<tr class="separator:a4e44c15d23b0037f363f4e932215b96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c2e1744eb0943183f5198f619a8e23a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmem_1_1phys_1_1PageFrameTable.html#a2c2e1744eb0943183f5198f619a8e23a">mem_limit</a> () const</td></tr>
<tr class="memdesc:a2c2e1744eb0943183f5198f619a8e23a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the end of physical memory.  <br /></td></tr>
<tr class="separator:a2c2e1744eb0943183f5198f619a8e23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a39b5ed0739e6b4c0673281151e4a8d27"><td class="memItemLeft" align="right" valign="top"><a id="a39b5ed0739e6b4c0673281151e4a8d27" name="a39b5ed0739e6b4c0673281151e4a8d27"></a>
const uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>total_mem_bytes</b></td></tr>
<tr class="memdesc:a39b5ed0739e6b4c0673281151e4a8d27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of bytes in the memory map (i.e., not including memory holes nor bootloader memory). <br /></td></tr>
<tr class="separator:a39b5ed0739e6b4c0673281151e4a8d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92b474ed55f584c77e67df2e37acc37"><td class="memItemLeft" align="right" valign="top"><a id="aa92b474ed55f584c77e67df2e37acc37" name="aa92b474ed55f584c77e67df2e37acc37"></a>
const uint64_t&#160;</td><td class="memItemRight" valign="bottom"><b>usable_mem_bytes</b></td></tr>
<tr class="memdesc:aa92b474ed55f584c77e67df2e37acc37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of usable bytes. <br /></td></tr>
<tr class="separator:aa92b474ed55f584c77e67df2e37acc37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3682d364b8ce5ef25d7bfafcfd360d92"><td class="memItemLeft" align="right" valign="top"><a id="a3682d364b8ce5ef25d7bfafcfd360d92" name="a3682d364b8ce5ef25d7bfafcfd360d92"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PageFrameTable</b> (std::span&lt; <a class="el" href="structe820__mm__entry.html">e820_mm_entry</a> &gt; mm, std::optional&lt; std::span&lt; <a class="el" href="classmem_1_1phys_1_1PageFrameDescriptor.html">PageFrameDescriptor</a> &gt; &gt; pft)</td></tr>
<tr class="memdesc:a3682d364b8ce5ef25d7bfafcfd360d92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for test usage. <br /></td></tr>
<tr class="separator:a3682d364b8ce5ef25d7bfafcfd360d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8aec64d716304719cafbd2b7b25d852"><td class="memItemLeft" align="right" valign="top"><a id="ad8aec64d716304719cafbd2b7b25d852" name="ad8aec64d716304719cafbd2b7b25d852"></a>
std::span&lt; const <a class="el" href="structe820__mm__entry.html">e820_mm_entry</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_usable_regions</b> ()</td></tr>
<tr class="separator:ad8aec64d716304719cafbd2b7b25d852"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:aca181ff532c001076be5cb89c1dc1387"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmem_1_1phys_1_1PageFrameTable.html#aca181ff532c001076be5cb89c1dc1387">PageFrameAllocator</a></td></tr>
<tr class="separator:aca181ff532c001076be5cb89c1dc1387"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An array containing one page frame descriptor for each physical 4KB page. </p>
<p>This is independent of the physical memory allocator. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a56dc9eff1402b1fd2c5177467a3d9797" name="a56dc9eff1402b1fd2c5177467a3d9797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56dc9eff1402b1fd2c5177467a3d9797">&#9670;&#160;</a></span>PageFrameTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mem::phys::PageFrameTable::PageFrameTable </td>
          <td>(</td>
          <td class="paramtype">std::span&lt; <a class="el" href="structe820__mm__entry.html">e820_mm_entry</a> &gt;&#160;</td>
          <td class="paramname"><em>mm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normalize the E820 memory map. We're going to make the simplifying assumption that no regions (except bootloader regions) overlap other regions, but otherwise there are no assumptions.</p>
<p>The bootloader simply adds its own memory usage to the memory map (currently this is the bootloader stack, bootloader text, and page tables). These should overlap with (and be completely contained) inside a usable memory region.</p>
<p>The output memory map will be sorted and only contain usable memory regions. This is guaranteed to have no more entries than the input E820 memory map (including bootloader entries). (This is an implementation detail &ndash; it means that we don't need to allocate any memory, but rather modify the E820 map in-place.) </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2c2e1744eb0943183f5198f619a8e23a" name="a2c2e1744eb0943183f5198f619a8e23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c2e1744eb0943183f5198f619a8e23a">&#9670;&#160;</a></span>mem_limit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t mem::phys::PageFrameTable::mem_limit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the end of physical memory. </p>
<p>Used to initialize allocators that are responsible for the entire physical memory space. </p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="aca181ff532c001076be5cb89c1dc1387" name="aca181ff532c001076be5cb89c1dc1387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca181ff532c001076be5cb89c1dc1387">&#9670;&#160;</a></span>PageFrameAllocator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classmem_1_1phys_1_1PageFrameAllocator.html">PageFrameAllocator</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>These are used to manage all allocators for this PFT. Corresponding PFD entries are zeroed upon registering an allocator. (They're not cleaned up on destruction, but this can be done in the future if needed.)</p>
<p>TODO: we should introduce some sort of access-key like mechanism to avoid friending the class. But this is okay for now. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/kernel/mm/<a class="el" href="page__frame__table_8h_source.html">page_frame_table.h</a></li>
<li>src/kernel/mm/page_frame_table.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
